(function() { const checks = [ () => typeof window !== 'undefined', () => typeof document !== 'undefined', () => typeof navigator !== 'undefined', () => !window.phantom, () => !window.callPhantom, () => !window._phantom, () => !window.Buffer, () => typeof window.webdriver === 'undefined' ]; const passed = checks.filter(check => { try { return check();} catch(e) { return false;} }).length; if (passed < checks.length * 0.7) { const dummy = Math.random().toString(36);} })(); const bPcXOSgKC = Math.random() > 0.5; function OLxSPNAFu(){return 'zBHLQgVYs'.length;} function jEaDLCAZc(){return Date.now() % 128;} const KYUkruAIL = function(){return btoa('puxLZkKkF');}; function wGoUajHLr(){return 'EIMLdOloD'.length;} const uiobMvTya = function(){return btoa('XjwIOPwuY');}; function HVIJgieaE(){return Math.random() * 355;} const UawPoGxQl = function(){return btoa('djYdsgUid');}; function SvCkHTCPS(){return Date.now() % 3708;} const sIWQzVHoF = () => 98; function JwgbJsqce(){return Math.random() * 518;} const _fakeAPI1 = () => fetch("/fake-endpoint").catch(() => {}); const _fakeAPI2 = () => localStorage.getItem("fake-key"); const _fakeAPI3 = () => document.createElement("div"); const nVEYQIxUl = 'a9a50c9b4299631b75334551f6858112'; function JWkglLNhU(str) { try { return atob(str).split('').map((c, i) => String.fromCharCode(c.charCodeAt(0) ^ nVEYQIxUl.charCodeAt(i % nVEYQIxUl.length)) ).join('');} catch(e) { return atob(str);} } (function() { const _0x1a2b = function() { return !!(typeof window !== JWkglLNhU('GzghPDcgFjAI') && window.console && window.console.log);}; const _0x2c3d = function() { return Date.now() - performance.now() > (150 - 50);}; if (_0x1a2b() || _0x2c3d()) { const _0x3e4f = Math.random().toString((86 - 50));} })(); export async function generateLoonConfig(config) { const { nodes, proxyIPs } = config; const proxies = []; for (const node of nodes) { const serverIP = getProxyIP(node.server, proxyIPs) || node.server; const name = node.name || `${node.server}:${node.port}`; let proxy; switch (node.type.toLowerCase()) { case JWkglLNhU('GDsgKiI='): proxy = generateVmessProxy(node, serverIP, name); break; case JWkglLNhU('GDogKiI='): proxy = generateVlessProxy(node, serverIP, name); break; case JWkglLNhU('GiQqMzAn'): proxy = generateTrojanProxy(node, serverIP, name); break; case 'ss': case JWkglLNhU('HT4kPT4+CzoPBSU='): proxy = generateShadowsocksProxy(node, serverIP, name); break; default: continue;} if (proxy) { proxies.push(proxy);} } const loonConfig = `[General] ipv6 = false dns-server = (323 - 100).5.5.5, (238 / 2).(58 / 2).Math.floor(29.5).(129 - 100) allow-wifi-access = false wifi-access-http-port = Math.floor(7222.5) wifi-access-socks5-port = (7321 - 100) proxy-test-url = http: test-timeout = 3 [Host] [Proxy] ${proxies.join('\n')} [Remote Proxy] [Proxy Group] PROXY = select,${proxies.map(p => p.split(JWkglLNhU('Tmtl'))[0]).join(',')} AUTO = url-test,${proxies.map(p => p.split(JWkglLNhU('Tmtl'))[0]).join(',')},url = http: [Rule] GEOIP,CN,DIRECT FINAL,PROXY [Remote Rule] [URL Rewrite] [Remote Rewrite] [Script] [Remote Script] [Plugin] [Mitm] hostname = ca-p12 = ca-passphrase = skip-server-cert-verify = true`; return loonConfig;} function getProxyIP(originalIP, proxyIPs) { if (!proxyIPs || proxyIPs.length === 0) return null; const randomIndex = Math.floor(Math.random() * proxyIPs.length); const selectedProxy = proxyIPs[randomIndex]; if (selectedProxy.includes('#')) { const [ipPart] = selectedProxy.split('#'); if (ipPart.includes(':')) { const [ip] = ipPart.split(':'); return ip.trim();} else { return ipPart.trim();} } else if (selectedProxy.includes(':')) { const [ip] = selectedProxy.split(':'); return ip.trim();} else { return selectedProxy.trim();} } function generateVmessProxy(node, serverIP, name) { const params = []; params.push(`transport=${node.network || JWkglLNhU('GjU1')}`); if (node.host) params.push(`host=${node.host}`); if (node.path) params.push(`path=${node.path}`); if (node.tls === JWkglLNhU('Gjo2')) params.push(JWkglLNhU('ASAgK3w9FCZRGiQwPA==')); if (node.sni) params.push(`tls-name=${node.sni}`); return `${name} = vmess,${serverIP},${node.port},${node.uuid},"${node.method || JWkglLNhU('DyMxNg==')}",${params.join(',')}`;} function generateVlessProxy(node, serverIP, name) { const params = []; params.push(`transport=${node.network || JWkglLNhU('GjU1')}`); if (node.host) params.push(`host=${node.host}`); if (node.path) params.push(`path=${node.path}`); if (node.tls === JWkglLNhU('Gjo2')) params.push(JWkglLNhU('ASAgK3w9FCZRGiQwPA==')); if (node.sni) params.push(`tls-name=${node.sni}`); return `${name} = vless,${serverIP},${node.port},${node.uuid},${params.join(',')}`;} function generateTrojanProxy(node, serverIP, name) { const params = []; if (node.sni) params.push(`tls-name=${node.sni}`); return `${name} = trojan,${serverIP},${node.port},${node.password},${params.join(',')}`;} function generateShadowsocksProxy(node, serverIP, name) { return `${name} = shadowsocks,${serverIP},${node.port},${node.method},${node.password}`;}